generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://alexandreac:sieges78@localhost:5432/im-tools"
}

model KoboServer {
  id       String     @id @default(uuid())
  url      String
  token    String
  KoboForm KoboForm[]
}

model KoboForm {
  id          String        @id @default(uuid())
  name        String
  server      KoboServer    @relation(fields: [serverId], references: [id])
  serverId    String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @default(now())
  uploadedBy  String?
  KoboAnswers KoboAnswers[]
}

model KoboAnswers {
  id                     String                   @id
  form                   KoboForm                 @relation(fields: [formId], references: [id])
  formId                 String
  start                  DateTime
  end                    DateTime
  version                String
  submissionTime         DateTime
  validationStatus       String?
  validatedBy            String?
  lastValidatedTimestamp Int?
  geolocation            String?
  answers                Json
  attachments            Json[]
  mpcaPaymentTools       MpcaPaymentToolAnswers[]
}

model MpcaPaymentTool {
  id                String                   @id @default(uuid())
  name              String?
  index             Int                      @unique() @default(autoincrement())
  budgetLineMPCA    String?
  budgetLineCFR     String?
  budgetLineStartUp String?
  headOfOperation String?
  cashAndVoucherAssistanceAssistant String?
  financeAndAdministrationOfficer String?
  city              String?
  createdAt         DateTime                 @default(now())
  updatedAt         DateTime                 @default(now())
  answers           MpcaPaymentToolAnswers[]
}

model MpcaPaymentToolAnswers {
  koboAnswers       KoboAnswers     @relation(fields: [koboAnswersId], references: [id])
  koboAnswersId     String
  mpcaPaymentTool   MpcaPaymentTool @relation(fields: [mpcaPaymentToolId], references: [id])
  mpcaPaymentToolId String
  createdAt         DateTime        @default(now())

  @@id([koboAnswersId, mpcaPaymentToolId])
}
